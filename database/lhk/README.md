## 정규화
### 꼭 알아두어야 할 것!
1. [이상 현상](#이상-현상)
2. [함수적 종속성](#함수적-종속성)
3. [정규형](#정규형)
#### 참고 자료 
- KOCW 데이터베이스의 원리와 응용, 백현미 교수님
- https://mangkyu.tistory.com/28

---

### 정규화
- **이상 현상을 제거**하면서 릴레이션을 분해하는 과정
- **함수적 종속성을 판단**하면서 정규화 수행

---

### 이상 현상
- 불필요한 데이터 중복으로 릴레이션에 대한 삽입, 수정, 삭제 연산시 발생하는 부작용

### 이상 현상 종류
1. 삽입 이상 - 데이터를 삽입하기 위해 **불필요한 데이터도 함께 삽입**해야 하는 문제

|아이디|주문제품|이름|등급|
|------|-------|---|----|

=> 아직 주문한게 없으면 데이터가 들어갈 수 없음! 임시의 주문번호를 넣어줘야 데이터 삽입 가능

2. 갱신 이상 - 중복 투플 중 **일부만 변경**하여 **데이터가 불일치**하게 되는 모순 문제

|아이디|주문제품|이름|등급|
|------|-------|---|----|
|A-101|아이패드|홍길동|vip|
|A-101|갤럭시탭|홍길동|gold|

=> 아이디가 A-101인 홍길동이 등급이 vip인지 gold인지 모순!

3. 삭제 이상 - 투플을 삭제하면 **꼭 필요한 데이터까지 삭제되는** 데이터 손실 문제

|아이디|주문제품|이름|등급|
|------|-------|---|----|
|A-101|아이패드|홍길동|vip|

=> 홍길동이 O-123 주문을 취소했을 때, 해당 투플을 날려버리면 홍길동 회원 자체가 날라감!

---

### 함수적 종속성
- 속성들 간의 관련성
- X -> Y (X: 결정자, Y: 종속자)
    1. X가 Y를 함수적으로 결정한다.
    2. Y가 X에 함수적으로 종속되어 있다.
- 릴레이션 내의 모든 투플을 대상으로 **하나의 X값에 대한 Y값은 항상 하나**
- 예시

|아이디|주문제품|이름|등급|
|------|-------|---|----|
|A-101|아이패드|홍길동|gold|
|A-999|갤럭시탭|홍길동|silver|
|A-444|아이패드|김이박|gold|

아이디 -> 이름

아이디 -> 등급

이름 -> 등급 (틀림, 이유: 동명이인 홍길동은 등급을 gold, silver 둘 다 가짐)

- 현재 값이 아닌 **속성 자체의 의미로 판단**해야 함
- 위의 예시에서 동명이인이 없다고 이름 -> 등급으로 판단하면 안된다. (값으로 동명이인이 들어오면 난리남)
- 일반적으로 기본키, 외래키가 모든 속성의 결정자 (다른 속성 값이 결정자인 경우도 존재)

### 완전 함수 종속
- 일반적인 함수 종속을 의미
- 릴레이션에서 속성 집합 Y가 속성 집합 X에 함수적으로 종속되어 있지만, 속성 집합 Y의 전체가 아닌 일부분에는 종속되지 않음
- 예시) {아이디, 이벤트 회차} -> 당첨여부
- 아이디, 이벤트 회차 각각으로 당첨여부를 결정할 수는 없음

### 부분 함수 종속
- 릴레이션에서 속성 집합 Y가 속성 집합 X의 전체가 아닌 일부분에도 함수적으로 종속됨
- 예시) {아이디, 주문제품} -> 이름
- 아이디만으로 이름을 결정 가능

### 이행적 함수 종속
- 릴레이션을 구성하는 세 개의 속성 집합 X, Y, Z에 대해 함수 종속 관계 X->Y, Y->Z가 존재하면 논리적으로 X->Z 성림
- 예시) 아이디 -> 등급, 등급 -> 할인율
- 아이디 -> 할인율 성립

---

### 정규형
- 릴레이션이 정규화된 정도
- 각 정규형마다 제약조건 존재
- 차수가 높아질수록 요구되는 제약조건이 많아지고 엄격
- 차수가 높아질수록 데이터 중복이 감소하여 이상 현상이 발생하지 않는 바람직한 릴레이션이 됨

### 제 1 졍규형
- 릴레이션에 속한 모든 속성의 도메인이 **원자값으로만 구성**
- 이상 현상 발생 이유? => **기본키에 완전 함수 종속되지 못하는 속성 존재** => 제 2정규형으로
- 예시) 기본키는 아이디, 주문제품

|아이디|주문제품|이름|등급|
|------|-------|---|----|
|A-101|아이패드|홍길동|gold|
|A-999|갤럭시탭|홍길동|silver|

=> 등급이 기본키 {아이디, 주문제품}에 완전 함수 종속되지 못함. (등급은 아이디만으로도 결정될 수 있음)

### 제 2정규형
- 릴레이션이 제 1정규형에 속하고, 기본키가 아닌 **모든 속성이 기본키에 완전 함수 종속**
- 예시

![image](https://user-images.githubusercontent.com/46019755/124612038-f6208680-deac-11eb-8493-f3f1663115f8.png)
- 이상 현상 발생 이유? => **이행적 함수 종속이 존재해서** => 제 3정규형으로

### 제 3정규형
- 릴레이션이 제 2정규형에 속하고, 기본키가 아닌 **모든 속성이 기본키에 이행적 함수 종속이 되지 않음**
- 예시

![image](https://user-images.githubusercontent.com/46019755/124612371-3c75e580-dead-11eb-8a45-a2bde10eaebd.png)

### 보이스-코드 정규형(BCNF)
- 후보키가 1개이고, 3NF 만족하면 BCNF도 만족
- **릴레이션에서 함수 종속성 X -> Y가 성립할 때 모든 결정자 X가 후보키여야 함**
- 예시

![image](https://user-images.githubusercontent.com/46019755/124612607-6deeb100-dead-11eb-8214-05a12836dc24.png)
