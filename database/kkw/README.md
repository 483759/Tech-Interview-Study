
# 데이터 모델링
## 데이터 모델링
### 데이터 모델링이란?
- 정보 시스템을 구축하기 위한 데이터관점의 업무 분석 기법
- 현실 세계의 데이터에 대한 약속된 표기법으로 표현하는 과정
- 데이터 베이스를 구착하기 위한 분석/설계 과정

### 데이터 모델의 기능
- 시스템을 현재 또는 원하는 모습으로 가시화하도록 도와준다
- 시스템의 구조와 행동을 명세화 할 수 있게한다
- 시스템을 구착하는 구조화된 틀을 제공한다
- 시스템을 구축하는 과정에서 결정한 것을 문서화한다
- 다양한 영역에 집중하기 위해 다른 영역의 세부 사항은 숨기는 다양한 관점을 제공
- 특정 목표에 따라 구체화된 상세 수준의 표현 방법을 제공

## 데이터 모델링의 중요성과 유의점
### 데이터 모델링의 중요성
- 파급효과 : 데이터 모델링이 초기에 제대로 이루어지지 않으면, 구현하고 테스트하는 과정에서 문제점이 나타날 수 있음. 모델을 변경해야될 경우, 다양한 분석이 추가로 필요함
- 복잡한 정보 요구사항의 간결한 표현 : 구축할 시스템의 요구사항과 한계를 가장 명확하고 간결하게 표현할 수 있게 해준다.
- 데이터 품질 : DB에 담긴 데이터는 기업/단체의 중요한 자산이다. 이러한 데이터의 보관 기간이 늘어날 수록 활용가치가 더 높아진다. 그러기 위해선 정확성과 품질이 높아야 한다.

### 데이터 모델링의 유의점
- 중복 : 한 DB가 여러 장소에 같은 정보를 저장하지 않도록 유의해야 한다.
- 비유연성 : 데이터의 정의를 데이터의 사용 프로세스와 분리하여  유지 보수시 위험성을 낮춘다
- 비일관성 : 데이터의 모순, 데이터와 데이터 간 상호 연관 관계에 대해 명호가하게 정의해서 방지한다. ( 중복이 없더라도 비일관성이 발생할 수 있다 )

## 데이터 모델링의 3단계
- 데이터 모델링을 하는데 있어서 시간에 따라 진행되는 3가지 과정이 있으며, 추상화 수준에 따라 달라지며 개념적 데이터 모델링, 논리적 데이터 모델링, 물리적 데이터 모델링으로 정리된다.

|데이터 모델링|내용|수준|
|-----------|----------------------------|:--------:|
|개념적 데이터 모델링|업무 중심적이고 포괄적인 수준의 모델링 진행|추상적|
|논리적 데이터 모델링|시슽메으로 구축하고자 하는 업무에 대해 Key 속성, 관계 등을 정확하게 표현|↓|
|물리적 데이터 모델링|실제 DB에 이식할 수 있도록 성능,저장 등 물리적인 성격을 고려하여 설계|구체적|

### 개념적 데이터 모델링
- 추상화 수준이 높고, 업무 중심적이고 포괄적인 수준의 모델링
- 어떤 자료가 중요하고 유지되어야하는지를 결정
- 핵심 엔티티와 그들간의 관계를 발견하고, 그것을 표현하기 위해서 엔티티-관계 다이어그램(ER Diagram)을 생성하는 것
- 사용자와 시스템 개발자가 데이터 요구 사항을 발견할 수 있도록 지원한다
- 현 시스템이 어떻게 변형되어야 하는가를 이해하는데 유용함

### 논리적 데이터 모델링
- 비지니스 정보의 논리적인 구조와 규칙을 명확하게 표현하는 기법 또는 과정
- 논리 데이터 모델링의 결과로 얻어지는 논리 데이터 모델은 데이터 모델링이 최종적으로 완료된 상태라고 정의할 수 있음
- 정규화가 이루어짐, 시스템으로 구축하고자 하는 업무에 대해 Key, 속성, 관계 등을 정확하게 표현하는 단계의 모델링이다
- 재사용성이 높음

### 물리적 데이터 모델링
- 실제 DB에 이식할 수 있도록 성능, 저장 등 물리적인 성격을 고려하여 설계하는 단계
- 데이터가 물리적으로 컴퓨터에 어떻게 저장될 것인가에 대해 정의하는 단계
- 테이블, 칼럼 등으로 표현되는 물리적인 저장구조와 사용될 저장 장치, 자료를 추출하기 위해 사용될 접근 방법 등을 결정함

  
  
 
## 데이터 독립성
- 단계별 스키마에 따라 데이터 정의어와 데이터 조작어가 다름을 제공
- 각 View의 독립성을 유지하고 계층별 VIew에 영향을 주지 않고 변경 가능

### 데이터 독립성의 필요성
- 유지 보수 비용 증가
- 데이터 중복성 증가
- 데이터 복잡도 증가
- 요구사항 대응 저하


### 데이터베이스의 3단계 구조
- 데이터 독립성을 가지는 모델은 다음과 같이 외부 단계, 개념적 단계, 내부적 단계로 서로 간섭되지 않는 모델을 제시한다.

### 외부 단계 (외부 스키마, External Schema)
- view 단계
- 여러 개의 사용자 관점으로 구성
- 개개인의 사용자 단계로서 개개인의 사용자가 보는 개인적인 DB 스키마
- DB의 개개 사용자나 응용 프로그래머가 접근하는 DB 정의

### 개념적 단계(개념 스키마, Conceptual Schema)
- 통합적인 관점
- 개념 단계 하나의 개념적 스키마로 구성되는 모든 사용자 관점을 통합한 조직 전체의 DB를 기술하는 것
- 모든 응용 시스템들이나 사용자들이 필요로 하는 데이터를 통합한 조직 전체의 DB를 기술한 것으로 DB에 저장되는 데이터와 그들간의 관계를 표현한 것

### 내부적 단계(내부 스키마, Internal Schema)
- DB가 물리적으로 저장한 형식을 나타냄
- 물리적 장치에서 데이터가 실제적으로 저장되는 방법을 표현

### 데이터 독립성
|독립성|내용|특징
|------------|--------------------------|:----:|
|논리적 독립성|개념 스키마가 변경되어도 외부 스키마에는 영향을 미치지 않도록 지원하는 것, 논리적 구조가 변경되어도 응용 프로그램에 영향이 없음|사용자 특성에 맞는 변경 가능, 통합 구조 변경 가능|
|물리적 독립성|내부 스키마가 변경 되어도 외부/개념 스키마는 영향을 받지 않도록 지원하는 것, 저장 장치의 구조 변경은 응용 프로그램과 개념 스키마에 영향이 없음|물리적 구조 영향없이 개념 구조 변경 가능, 개념 구조 영향없이 물리구조 변경 가능|

## 좋은 데이터 모델의 요소
1. 완정성 : 업무에 필요로 하는 모든 데이터가 데이터 모델의 정의되어 있어야 함
2. 중복 배제 : 하나의 DB 내에는 동일한 사실은 반드시 한 번만 기록 되어야 함
3. 업무 규칙 : 데이터 모델링 과정에서 도출되고 규명되는 수많은 업무 규칙을 데이터 모델에 표현하고 이를 해당 데이터 모델을 활용하는 모든 사용자가 공유할 수 있도록 제공해야함
4. 데이터 재사용 : 데이터의 통합성과 독립성에 대해서 충분히 고려하여 데이터의 재사용성을 향상시킬 수 있어야함
5. 의사 소통 : 업무규칙들은 해당 정보세스템을 운용, 관리하는 많은 관리자들이 설계자가 정의한 업무규칙들을 동일한 의미로 받아들이고 정보시스템을 활용할 수 있게 하는 역할과 데이터 모델이 진정한 의사소통의 도구로서의 역할을 하게 
6. 통합성 : 동일한 성격의 데이터를 한 번만 정의함으로써 공유 데이터에 대한 구조를 여러 업무 영역에서 공동으로 사용하기 용이하도록 해야함

## 디자인 스키마
### 스타 스키마
- 하나의 사실 테이블을 중심으로 다수의 차원 테이블들로 구성한 형태
- 사실 테이블은 일반적으로 제 3정규형으로 모델링
- 차원 테이블은 일반적으로 제 2정규형으로 모델링
- 장점 : 복잡도가 낮고 이해하기 쉬움, 쿼리 작성이 용이하고 조인 수가 적음
- 단점 : 비정규화에 따른 데이터 중복 발생, 상대적으로 성능이 저하됨

 
### 눈송이 스키마
- 스타 스키마를 기본으로, 차원 테이블을 제 3정규형으로 구성한 형태
- 장점 : 데이터 중복 제거, 디스크 절감
- 단점 : 스키마 구조의 복잡성이 증가, 조인 테이블 개수 증가



-------------------------------
# 질문 정리
## 인덱스 질문
Q. DB 인덱스에 대해 설명해주세요
```
DB의 검색속도를 향상 시키기 위해 저장공간의 일부를 사용하여 데이터와 데이터의 위치를 포함시키는 자료구조이다.
다만, 잦은 데이터 변경이 이뤄지는 경우에는 오히려 성능의 저하를 일으킬 수 있으니 상황에 따라 사용하는 것이 중요합니다.

```
Q. DB 인덱스를 사용하는 이유는 무엇인가요?
```
기본 키 외의 다른 열의 내용으로 검색하거나 정렬 할 때 매 번 Full scan을 하게 되니 시간이 오래걸린다. 
이를 대비하여 검색 속도를 향상 시키기 위해서 사용합니다.
```
Q. DB 인덱스에 해쉬 보다 B Tree를 쓰는 이유는 무엇인가요?
```
항상 정렬된 상태로 연속된 값에 대한 탐색에도 사용하기 용이하며
참조 포인터가 상대적으로 적어 데이터 양이 많아도 빠른 메모리 접근이 가능합니다.
탐색 뿐만 아니라 데이터 삽입, 수정, 삭제 등의 연산에서 항상 O(log N)의 복잡도를 가지어 최소한의 속도를 보장해줍니다.
```

## 관겨형 DB vs 비관계형 DB
Q.관계형 DB 와 비관계형 DB 의 차이점에 대해 설명해주세요.
```
관계형 DB는 키와 관계를 나타내는 테이블로 이루어져 데이터의 종속성을 관계로 표현하는 것이 관계형 데이터 베이스입니다. 신뢰성이 높고 정렬이나 탐색,분류 등의 속도가 빠릅니다.
비관계형 DB는 테이블 형식의 스키마를 사용하지 않는 DB로 데이터의 형식을 요구되는 특정 상항에 맞게 최적화된 모델을 사용합니다. 그렇기에 유연하며 성능이 뛰어납니다.
```
Q.RDBMS과 비교하였을 때 NoSQL의 장점을 설명해보세요.
```
NoSQL은 데이터의 구조를 미리 지정하지 않아도 되어 비정형 데이터를 저장하는데 유리하며, 반복적이고 빠른 개발이 가능합니다.
수직적 확장만 가능한 RDBMS와 달리 수평적 확장도 가능하며 이을 통해 비용을 감소할 수 있어 대용량 데이터를 저장할 때도 유리합니다.
```
Q.어떤상황에서 NoSQL을 쓰는 것이 더 적합한가?
```
빅데이터를 처리하거나 데이터 구조가 자주 변경되는 경우, 데이터가 지속적으로 추가되며 DB가 확장되야 하는 경우
```

## 트랜잭션(Transaction)
Q.트랜잭션이란?
```
DB의 상태를 변환시키는 하나의 논리적 기능을 수행하기 위한 작업 단위 또는 한번에 수행되어야 할 일련의 연산들을 의미
```
Q.트랜잭션의 성질 ACID
```
- 원자성 : 트랜잭션의 연산은 DB에 모두 반영되거나 모두 반영되지 않아야 한다. 반드시 트랜잭션 내의 모든 명령은 완벽히 수행되어야 하므로, 하나라도 문제가 있으면 모두 수행되지 않아야 한다.
- 일관성 : 트랜잭션이 성공하면 언제나 일관성 있는 DB 상태로 변환한다. 시스템이 가지는 고정 요소들은 수행 완료 후와 전이 항상 같아야 한다.
- 독립성 : 둘 이상의 트랜잭션이 동시에 실행될 때, 어느 하나의 트랜잭션은 다른 트랜잭션의 연산에 관여할 수 없다. 또한 수행이 완료될 때까지 결과를 참조할 수 없다
- 지속성 : 성공적으로 완료된 트랜잭션의 결과는 시스템에 문제가 생겨도 영구적으로 반영되어야 함
```
Q.트랜잭션을 병행으로 처리할 때 발생할 수 있는 문제점과 이를 방지하기 위한 방법
```
갱신 내용 손실 : 동시에 동일한 데이터가 갱신될 때 하나의 갱신이 누락되지 않는 경우
현황 파악 오류 : 하나의 데이터에 대해 갱신이 끝나지 않은 시점에서 다른 트랜잭션이 해당 데이터를 조회하는 경우
모순성 : 두 트랜잭션이 동시에 실행될 때 DB가 일관성이 없는 모순된 상태로 남는 문제
연쇄 복귀 : 두 트랜잭션이 하나의 레코드를 갱신할 때 하나의 트랜잭션이 롤백 하는 경우, 다른 하나의 트랜잭션도 같이 롤백되는 문제

이를 방지하기 위한 방법으로 Locking 제어 기법을 사용
- 어떤 트랜잭션이 특정 DB의 데이터를 사용할 때 DB의 일정 부분을 Lock 시키고 트랜잭션이 완료될 때 해당 부분을 Unlock 시키는 방법
```
Q.(3-1) Locking 제어 기법을 사용할 때 Locking 단위를 크게/작게 했을 때의 차이점
```
단위가 큰 경우 : 관리가 쉽지만 병행성이 떨어짐
단위가 작은 경우 : 관리가 어렵고 오버헤드가 증가하지만 병행성이 올라감
```

Q.(3-2) Locking 제어가 일으킬 수 있는 문제점
```
트랜잭션의 직렬화 가능성이 높아짐
Deadlock 발생할 수 있음
```
Q.트랜잭션에 의해 발생할 수 있는 데드락에 대해 설명
```
여러 개의 트랜잭션들이 어느 자원의 Lock을 획득한 채 다른 트랜잭션이 소유하고 있는 잠금을 요구하여 서로 진행을 하지 못하고 무한정 기다리는 상태
```
Q.(6-1) 데드락을 방지할 수 있는 방법은?
```
탐지 기법 : 매번 데드락이 발생하는지 검사하는 방식 -> 코스트가 큼
예방 기법 : 각 트랜잭션이 실행되기 전에 필요한 데이터를 모두 Locking 해주는 방법 -> 데이터가 많이 필요하면 모든 데이터를 전부 Locking 해주어야 하므로 병행성을 보장하지 못함
- wait-die : 기다리거나 포기하는 방식
- Wound-wait : 빼앗아오거나 대기하는 방식
```
Q.트랜잭션 격리 수준의 각 레벨에 대해 간략하게 설명
```

```



## 데이터 모델링 질문
Q. 다양한 데이터 모델에 대해서 설명하시오
```
개념적, 논리적, 물리적 모델 세 가지 유형이 있습니다. 개념적 모델링이 제일 추상적이고 물리적 모델링이 제일 구체적인 개념입니다.
개념적 모델은 엔티티의 이름과 관계만 표현하며
논리적 모델은 엔티티의 이름, 관계, 속성, 기본 키 및 외래 키가 표시 됩니다.
물리적 모델은 기본 키 및 외래 키, 테이블 이름, 열 이름 등 이를 실제 DB에서 어떻게 구현되는지를 자세히 나타납니다.
```

Q. 데이터 모델링의 디자인 스키마에 대해서 설명해주세요
```
디자인 스키마로 스타 스키마와 눈송이 스키마가 존재합니다.
스타 스키마는 하나의 사실 테이블을 중심으로 다수의 차원 테이블들이 구성된 형태인데,
사실 테이블은 제 3정규형이지만 차원 테이블은 제 2정규형으로 이루어져 있어 이해하기 쉬우며 쿼리 작성에 용이합니다.
하지만 데이터의 중복 발생이 있어 성능적으로 상대적으로 저하가 있습니다.
눈송이 스키마는 스타 스키마를 중심으로 차원 테이블을 제 3정규형으로 구성한 형태입니다.
데이터의 중복이 제거되어 디스크의 용량적인 절감을 가져와 성능적으로 우수하지만 스키마의 구조가 복잡합니다.
```

Q. 둘 중에 더 좋은 스키마에 대해서 설명 해주세요
```
프로젝트의 요구 사항에 따라 다릅니다.
차원 테이블에 적은 수의 행이 포함된다면 스타 스키마가 유리하겠지만
중복 정보와 공간이 포함 된 많은 행이 저장될 때는 눈송이 스키마가 유리하다고 볼 수 있습니다.
```

## 정규화
Q.정규화란 무엇인지, 필요한 이유와 함께 답변해주세요.
```
테이블 간에 데이터를 허용하지 않음으로서 무결성을 유지하는 것
이로 인 하여 DB의 저장 용량을 줄일 수 있습니다
```
Q.각 정규화 단계에 대해 만족되어야 할 조건을 중심으로 설명해주세요.
```
제 1정규형
- 테이블의 칼럼이 원자값을 갖도록 테이블이 분해된 것입니다.
제 2정규형
- 1정규화를 만족하며 모든 속성들은 오직 개체의 고유 식별자(유일키)에만 의존해야함. 
- 기본키를 제외한 속성은 기본키에 완전 함수 종속되어야함
제 3정규형
- 제 2정규화를 만족해야함
- 테이블 키 외에 다른 속성에 의존하는 요소가 존재하면 안됨 
- 이행적 종속을 없애도록 테이블을 분해하는 것 (*이행적 종속 : A->B, B->C가 성립할 때 A->C가 성립하는 것)

BCNF 정규형
- 제 3정규화를 진행한 테이블에 대해 모든 결정자가 후보키가 되도록 테이블을 분해하는 것

제 4정규형
- 한 릴레이션에서 다치종속을 제거한 정규형 

제 5정규형
- 한 릴레이션에서 조인 종속이 후보키를 통해서만 성립이 되도록 한 정규형

```

